---
title: "Assignment 4"
author: "Juntong Wei, Qin Xu, Xuanming Liang, Ziang Li"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(readr)
```

```{r}
data <- read_csv("data/athlete_events.csv")
dat1 <- read_csv("data/countries.csv")
```
#Introduction 

\section*{Comparing Olympic medals result for athletes of different age by gender}
## First question: Compare the total medal won by different age for both female and male.
```{r data}
data<- read.csv("Data/athlete_events.csv")
```

```{r data_wrangling1}
clean_data <- data %>% 
  select (c("Sex","Age","Medal")) %>% 
  mutate(Sex=as.factor(Sex),
        Medal= as.factor(Medal)) %>% 
  group_by(Sex,Age) %>% 
  count(Medal) 

clean_data
```
```{r data_wrangling2}
clean_data1 <- clean_data %>% 
mutate(age_group = cut(Age,breaks = c(0,15,30,45,60,75,90))) %>% 
select(-Age) %>% 
  group_by(Sex,age_group) %>% 
  count(Medal) %>% 
  rename(number = "n")
clean_data1
```

```{r data_wrangling3}
table1<- clean_data1 %>% 
    group_by (Sex,age_group) %>% 
  summarise(total_medal_in_age_group= sum(number))
  
table1
```

```{r table1,  eval = TRUE, echo = FALSE, warning=FALSE, message=FALSE}

percentage<- table1 %>% 
  group_by(Sex) %>% 
summarise(total_medal_by_sex =sum(total_medal_in_age_group)) %>% 
  left_join(table1, by ="Sex") %>% 
  mutate("Percentage" = ((total_medal_in_age_group/total_medal_by_sex)*100)) 

  knitr::kable (percentage ,caption = "compare the percentage of thetotal medal won by different age groups for both female and male") %>% kable_styling()
  
```
In Table \@ref(tab:table1) we compare the total medal won by different age groups for both female and male.

From this table, it shows that female younger athletes age range from 15- 30 has the highest percentage (32.09%) of total medal won compared to other age group, while older female athletes age from 60 to 75 has the least percentage of medal won (8.02%). However, for males athletes, it appears that age group between (15-30),(30-45),(45-60_ share the same percentage( and highest) of total medal won, while older male athletes age form 75 to 90 again has the least percentage of medal won ( 2.52%).

```{r figure1, fig.cap="The percentage of total medal won in different age group by sex", fig.height = 5, fig.width = 6, fig.align='center', eval = TRUE, echo = FALSE, warning=FALSE, message=FALSE}

plot <- ggplot(data = percentage, 
                      aes(x = age_group,
                          y= Percentage,
                          fill = Sex)) +
    geom_bar(stat="identity",position ="fill") +
    ggtitle("Total medal won by different age group for female and male ")
plot
```

In Figure \@ref(fig:figure1), we have plotted the percentage of the total medal won by different age group and compared in against both gender of male and female.

\@ref(fig:figure1),  depicts that for the age groups aged (0-15),(15-30),and (30-45), female athletes is accounted of  a higher proportion  of the total medal compared to males, However by the age group (45 to 60), males athletes exceed female athletes in the proportion of  total medal won and continues to have a higher proportion than female in the older age bracket. 

##Second question: Comparison of different medal distribution between age group by gender. 


